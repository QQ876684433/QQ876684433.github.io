---
title: 数据库课堂笔记（2019-09-03）
date: 2019-09-03 19:53:37
categories:
- 数据库
- 笔记
tags:
- 数据库
---

# 数据库课堂笔记

> 参考资料：
>
> - 南大软件学院课程《数据管理基础》课程资料
> - 《数据库原理、编程与性能》原书第二版 - Patrick O‘Neil、Elizabeth O’Neil 著
> - 《数据库系统概论》第五版 - 王珊 萨师煊 著
> - 《数据库系统概念》



## 数据库课堂笔记（2019-09-03）

### Ch1. Introduction

#### 术语

- 数据库管理系统（DataBase Management System，DBMS）

  Connolly and Begg define Database Management System (DBMS) as a "**software system that enables users to define, create, maintain and control access to the database**". ... **The core functionality is the storage, retrieval and update of data**.

  > The [database management system](https://en.wikipedia.org/wiki/Database#Database_management_system) (DBMS) is the [software](https://en.wikipedia.org/wiki/Software) that interacts with [end users](https://en.wikipedia.org/wiki/End_user), applications, and the database itself to capture and analyze the data.
  >
  > ------ from wikipedia

  简单理解就是，数据库管理系统是终端用户、应用程序同**数据库本身**交互的软件

- 数据库（Database）

  > A **database** is an organized collection of [data](https://en.wikipedia.org/wiki/Data_(computing)), generally stored and accessed electronically from a computer system. Where databases are more complex they are often developed using formal [design and modeling](https://en.wikipedia.org/wiki/Database#Design_and_modeling) techniques.
  >
  > ------ from wikipedia

  简单理解就是，数据库是**一个有组织的数据集合**

- 数据库用户（DataBase User）

  - 最终用户——交互式用户

    - 临时用户——用SQL访问DBMS的用户
    - 初级用户——通过菜单访问DBMS的用户

  - 应用程序员——编写菜单程序的程序员

  - 数据库管理员（Database Administrator，**DBA）——管理DBMS的专家**

    ![](https://i.loli.net/2019/09/03/EOwYuHP6gxaQci4.png)

### 数据库系统的架构

![](https://i.loli.net/2019/09/03/LPcK7sEfn54vDgG.png)

主要有**两层C/S架构**和**三层B/S架构**两种：

- 两层C/S架构：数据库和DBMS运行在数据库服务器，数据库应用程序运行在客户机中，两者之间通过局域网实现数据访问（*但是更多的时候， 数据库服务器及其应用程序可能分布在距离遥远的不同地方，这时得使用三层B/S架构来解决*）
  

![](https://i.loli.net/2019/09/03/mv7GcaV85YwBzZp.png)

- 三层B/S架构：数据库和DBMS运行在数据库服务器中，数据库应用程序运行在应用服务器（也称“Web服务器”）中， 用户客户端只需要安装常用的浏览器， 负责接收用户输入和结果展示
  
  ![](https://i.loli.net/2019/09/03/NUSipYC8havWjgk.png)

### 数据模型

数据模型（data model）是对现实世界数据特征的抽象，它是数据库系统的核心和基础。根据应用的不同目的可以划分为两大类：第一类是概念模型，第二类是逻辑模型和物理模型。

- 概念模型：按用户的观点来对数据和信息进行建模，主要用于数据库设计
- 逻辑模型：按计算机系统的观点对数据建模，主要用于数据库管理系统的实现
- 物理模型：对数据最底层的抽象，它描述数据在系统内部的表示方式和存取方法

#### 概念模型

- 实体（entity）：客观存在并可互相区别的事物
- 属性（attribute）：实体所具有的某一特性
- 码（key）：唯一标识实体的属性集
- 实体型（entity type）：用实体名及其属性名集合来抽象和刻画同类实体
- 实体集（entity set）：同一类型实体的集合
- 联系（relationship）：实体之间的联系通常是指不同实体集之间的联系，具有一对一、一对多和多对多等多种类型

概念模型的表示方法：实体-联系方法（Entity-Relationship approach），E-R方法也称为E-R模型

数据模型的组成要素：

- 数据结构：数据库的组成对象以及对象之间的联系
- 数据操作：对数据库汇总各种对象的实例运行执行的操作的集合，包括操作以及有关的操作规则
- 数据的完整性约束条件：一组完整性规则

#### 常见的数据模型

##### 层次数据模型（Hierarchical Data Model ）

满足两个条件：

- 有且只有一个结点没有双亲结点，这个结点称为根结点
- 根以外的其他结点有且只有一个双亲结点

层次模型中，每个结点表示一个记录类型，记录类型之间的联系用结点之间的有向边表示，这种联系是父子之间的一对多的联系，可以看做**有向树结构**

##### 网状数据模型（Network Data Model）

即有向无环图

满足两个条件：

- 允许一个以上的结点无双亲
- 一个结点可以有多于一个的双亲

层次模型中子女结点与双亲结点的关系是唯一的，在网状模型中，这种关系可以不唯一

##### 关系模型（Relational Model）

从用户的观点看，关系模型由一组关系组成，每个关系的数据结构都是一张**规范化的二维表**：

- 关系：一个关系对应通常说的一张表
- 元组：表中的一行即为一个元组
- 属性：表中的一列即为一个属性
- 码：也称为码键，它是表中的某个属性组，可以唯一确定一个元组
- 域：域是一组具有相同数据类型的值集合，属性的取值范围来自某个域
- 分量：元组中的一个属性值
- 关系模式：对关系的描述，通常表示为`关系名(属性1，属性2，属性3，...，属性n)`

##### 面向对象模型（Object-Oriented Model）

##### 对象关系模型（Object-Relational Model）



### Ch2. The Relational Model

#### CAP数据库

![](https://i.loli.net/2019/09/15/iuv9bsDBzYrlxfH.png)

![](https://i.loli.net/2019/09/15/iWSvPMBGA8Ugund.png)

![](https://i.loli.net/2019/09/15/zhZUMOiyYNAvbCG.png)

![](https://i.loli.net/2019/09/15/HjTJYBkUtcneDRm.png)

#### 术语

- **数据模型（Data Model）**：也称为数据库模型

  - 它是一组描述如何用计算机化的信息表示现实世界中的数据的定义
  - 也描述了**访问**和**更新**这些信息的操作类型

- **数据库（Database）**：**表（Table）**，或者说**关系（Relation）**的集合

- **表的标题（Table Heading）**：表的**列名（Column Name）**集合，又称为**模式（Scheme）**

  ![](https://i.loli.net/2019/09/06/I9yhKi46BRAufOP.png)

- 表的**行（Row）**集合：也就是**元组（Tuple）**的集合，称为表的内容，表的行数称为表的基数

![](https://i.loli.net/2019/09/06/FP2NDfJ3zABGlWc.png)

#### 数据库各部分的命名

由于数据库的行是经常改变的，而列通常来说不会改变，一般推荐数据库用户使用列来进行数据库查询

##### 程序数据独立性（Program-Data Independence ）

> when asked to make up a query to answer a question, query must still answer the question even if all the data changes.

<u>查询语句</u>和<u>表的数据</u>无关，二者是相互独立的，即使数据库中的表数据改变了，原有的查询依然能够执行（但是查询结果可能发生了改变）

##### 域类型（Column type，也称 Domain和 Datatype）

![](https://i.loli.net/2019/09/06/4NQEAOFYoPzXt8a.png)

- 大多数商业数据库系统都不支持有枚举集组成的类型（如city，month等），它体现了数据库的**完整性约束（Integrity）**

  > **域完整性（Domain Integrity）** 
  > 域完整性是指保证指定列的数据具有正确的数据类型、格式和有效的数据范围。

- **particular type**

  例子：Domain(city in CUSTOMERS) vs
  Domain(city in AGENTS) ?

  ![](https://i.loli.net/2019/09/06/3IUhzBc2NtJkwag.png)

  ![](https://i.loli.net/2019/09/06/2RnTzvfjHdbMVZA.png)

##### 关系代数（Relational Algebra ）

数据表中的列的域类似于大多数编程语言中的枚举类型

![](https://i.loli.net/2019/09/06/zF83mwJsyaNvYHM.png)

![](https://i.loli.net/2019/09/06/xueCP3KHmVn4cIr.png)

##### 笛卡尔积

数学上的笛卡尔积定义：

![](https://i.loli.net/2019/09/11/XHPZu8mCs9biJfL.png)

但是数据表的关系——即行的集合并没有包含数据表所有列的笛卡尔积中的所有元素，一般来说有如下关系：

![](https://i.loli.net/2019/09/11/O9k6jhLcb1sXWPz.png)



#### 关系规则

**数据库范式（Database Normalization）**：一张数据表的表结构所符合的某种设计标准的级别。符合高一级范式的设计，必定符合低一级范式，例如符合2NF的关系模式，必定符合1NF。

数据库三大范式：

![](https://i.loli.net/2019/09/11/ov6eLOjT4EaNVci.png)

##### 第一范式（1NF）：First Normal Form Rule

数据表的列不允许有多值属性（重复的域）或者属性具有内部结构，也就是说要求列属性是原子的。

> columns that have multi-valued attributes (repeating fields) or have any internal structure (record) are not permitted

![](https://i.loli.net/2019/09/11/DCoqxLYdlN8Wcmj.png)

以这个数据表为例，`name`具有内部结构，`enrollment`是多值属性（重复的域）（*实际上enrollment也具有内部结构*）

它有两方面的含义：

- 多值属性（重复的域）意思是某个属性的取值是某些元素的列表或者集合，例如第一行中的enrollment属性取值是((101, No), (108, Yes))，它是元素(cno, major)的列表或集合，解决方法有三种：

  - 将多值属性拆分成多个属性 ->（**浪费空间并使得查询变得困难**）
  - 将具有多值属性的行（元组），按照多值属性的值集合拆分成多个行（元组）来表示，新的元组不再包含多值属性，这些元组在该属性的取值的集合等于原多值属性取值 -> （**包含大量冗余数据，浪费空间**）
  - 将多值属性和其他属性分拆到两个不同的表中，通过表的join运算来获得原数据表 ->（**最常用的操作**）

- 内部结构意思是某个属性的取值不是原子的，或者是不是基本类型，例如name属性具有内部结构(name.Iname, name.fname)，解决方法是：

  ![](https://i.loli.net/2019/09/11/IHocynCRgkUAuMe.png)

*ps：第一范式规则被对象-关系数据库系统的数据表打破，这些表是非第一范式（NFNF）。*

##### 第二范式（2NF）：Access Rows by Content Only Rule

只能基于内容存取行的规则，说明我们只可以通过行的内容即每一行中所存在的属性值来检索列

> can only retrieve rows by their content, the attribute values that exist in each row.

它暗示了：

- 行是无序的：即使用行号来访问数据表中指定行是无意义的

  ![](https://i.loli.net/2019/09/15/2YerOAFicub759g.png)

- **列是无序的**：2NF中没有指明需要根据一定的属性次序来访问指定行

*ps：大多数的关系型数据库产品打破了这条规则，允许用户通过RID-row ID来访问行；而且新的对象-关系数据库产品有`refs`语法允许某一行上列值指向另一行。*

##### 第三范式（3NF）：The Unique Row Rule

行唯一性规则，它要求关系中任何两个元组的值在同一时刻不能是完全相同的，也就是说**关系是元组的无序集合**

![](https://i.loli.net/2019/09/15/njuJqea9ZcNTSfA.png)

![](https://i.loli.net/2019/09/15/TbAfJF4jM5exQk6.png)



